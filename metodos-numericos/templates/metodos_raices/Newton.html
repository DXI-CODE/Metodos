<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Método de Newton-Raphson</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            margin-top: 20px;
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <h1>Método de Newton-Raphson</h1>
    <form id="newton-form">
        <label for="x0">Valor inicial (x0):</label>
        <input type="number" id="x0" step="0.01" required>
        <br><br>
        <label for="tol">Tolerancia:</label>
        <input type="number" id="tol" step="0.0001" required>
        <br><br>
        <label for="max_iter">Iteraciones máximas:</label>
        <input type="number" id="max_iter" required>
        <br><br>
        <button type="submit">Calcular</button>
    </form>

    <div id="resultados" class="hidden">
        <h2>Resultados:</h2>
        <div id="tabla-resultados"></div>
        <h3>Gráfica del Método</h3>
        <img id="grafica" alt="Gráfica del Método de Newton-Raphson">
    </div>

    <script>
        document.getElementById("newton-form").addEventListener("submit", async function(event) {
            event.preventDefault();
            const datos = {
                x0: parseFloat(document.getElementById("x0").value),
                tol: parseFloat(document.getElementById("tol").value),
                max_iter: parseInt(document.getElementById("max_iter").value)
            };
            try {
                const response = await fetch("/newton", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(datos)
                });
                const resultado = await response.json();
                if (resultado.error) {
                    alert("Error: " + resultado.error);
                } else {
                    document.getElementById("tabla-resultados").innerHTML = resultado.tabla;
                    document.getElementById("grafica").src = "data:image/png;base64," + resultado.grafica;
                    document.getElementById("resultados").classList.remove("hidden");
                }
            } catch (error) {
                console.error("Error:", error);
            }
        });
    </script>
</body>
</html>
